  
{$CLEO .cs} 

const
    SCRIPT_NAME  =   "4_admin_tools(main_funcs)"
    scritpPath   =   "CLEO\SAMP++\core\4_admin_tools(main_funcs).ini"
    VERSION      =   "0.0.2 build 772"
        
end
 
const 
    _Library                                =       0@
    _Init_Client_backgraund_Thr             =       1@
    _Public_InPutDimByCLEO                  =       2@
    _Public_output_DimByCLEO                =       3@
end

const
    i           = 1@
    Veh         = 2@ 
    Structura   = 6@
    mark        = 7@
    
end

var
    i           :   integer
    Structura   :   integer
end

 
0000: 
 
// flag start
if          
    0@ == 1
then
    goto @initcializatciia 
else
    goto @panik_unload    
end
 
:initcializatciia
    // load .dll
    if                                  
        0AA2: _Library = load_library "SAMP++.dll"    
    jf @panik_unload
        0AF1: write_int _Library to_ini_file scritpPath section SCRIPT_NAME key "SAMP++"   
           
    // get ptr "Init_Client_backgraund_Thr"     
    if
        0AA4: _Init_Client_backgraund_Thr = get_proc_address "Init_Client_backgraund_Thr" library _Library  
    jf @free_lib_and_end_custom_thread
        0AF1: write_int _Init_Client_backgraund_Thr to_ini_file scritpPath section SCRIPT_NAME key "Init_Client_backgraund_Thr"  
     
    // Public_output_DimByCLEO
    if                                                       
        0AA4: _Public_InPutDimByCLEO = get_proc_address "Public_InPutDimByCLEO" library _Library  
    jf @free_lib_and_end_custom_thread
        0AF1: write_int _Public_InPutDimByCLEO to_ini_file scritpPath section SCRIPT_NAME key "Public_InPutDimByCLEO" 
      
    // get ptr "Public_InPutDimByCLEO"
    if 
       0AA4: _Public_output_DimByCLEO = get_proc_address "Public_OUTPUT_DimByCLEO" library _Library
    jf @free_lib_and_end_custom_thread
       0AF1: write_int _Public_output_DimByCLEO to_ini_file scritpPath section SCRIPT_NAME key "Public_OUTPUT_DimByCLEO" 
    
    //CONNECT to SERVER    
    0AA5: call _Init_Client_backgraund_Thr  num_params 0 pop 0  
    wait 2000 
goto @main                


   
:main
while true
    wait 11
    if 
       Player.Defined($PLAYER_CHAR)
    then      
        gosub @5_Cleo_TestDebug_SCRIPT
        gosub @5_getServerCar_SCRIPT
        gosub @6_PasserCarHeandleGameMap_SCRIPT
        gosub @6_Cleo_GetHeeandleCarPool
//        gosub @6_Theread_Control_Car_Healch
    end
end // end while

:6_PasserCarHeandleGameMap_SCRIPT
if 
    0AB0:  key_pressed 52  // ?   
        then  
//            0A92: create_custom_thread "6 Passer Car.cs" 1
            0AB1: call_scm_func @parse_Heandle_car_funcs  2 0 i   
                end    
return 
 
  
:5_getServerCar_SCRIPT
wait 0
if 
    0AB0: key_pressed 49 // 1
        then    
            018C: play_sound 1054 at 0.0 0.0 0.0
                0A92: create_custom_thread "5_getServerCar.cs" 1 _Library _Public_InPutDimByCLEO
                    wait 900
                        end
return    
 
:5_Cleo_TestDebug_SCRIPT 
wait 0
if
    0AB0: key_pressed 50 // ?
        then 
//            0A99: chdir "cleo"                  
//                0A92: create_custom_thread "\SAMP++\MyUtiletes\3_sound.cs" _start_flag 1 _Library
                0A92: create_custom_thread "3_sound.cs" _start_flag 1 _Library                                                            
                    wait 300                 
                        end                 
return  

:6_Cleo_GetHeeandleCarPool
wait 0
if
    0AB0: key_pressed 51  // 3
        then 
            018C: play_sound 1053 at 0.0 0.0 0.0
                20@ = 5.0           // design get car Heandle
                    0AA5: call_function _Public_InPutDimByCLEO num_params 9 pop 9 12@v 13@v 14@v 15@v 16@v 17@v 18@ 19@ 20@v                                                                                                                              
                        end
return  

//:6_Theread_Control_Car_Healch
//    20@ = 4.0           // design get car Heandle
//    0AA5: call_function _Public_InPutDimByCLEO num_params 9 pop 9 12@v 13@v 14@v 15@v 16@v 17@v 18@ 19@ 20@v                                                                                                                              
//return

:free_lib_and_end_custom_thread 
0AA3: free_library 0@       
0A93: end_custom_thread
 
     
:panik_unload
0A93: end_custom_thread
  
:parse_Heandle_car_funcs 
for i = 0 to 100
    0AB1: call_scm_func @Write_To_Ini_Files 2 0 i // => writr ini
end
04C4: store_coords_to 3@ 4@ 5@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.0 
i=0 
if 
    0AE2: 2@ = random_vehicle_near_point 3@ 4@ 5@ in_radius 999.0 find_next 0 pass_wrecked 1 //IF and SET 
then
    repeat
        if 
            056E:  2@    //car.Defined(   )  
        then
            marker.CreateAboveCar(7@, 2@)
            0AD1: show_formatted_text_highpriority   "Car Count:  %d" time 11 i
            wait 11
            0AB1: call_scm_func @Write_To_Ini_Files 2 2@ i // => writr ini
            inc(i)
            marker.Disable(7@)
        end 
    until 8AE2: not 2@ = random_vehicle_near_point 3@ 4@ 5@ in_radius 999.0 find_next 1 pass_wrecked 1
    0AD1: show_formatted_text_highpriority   "Car Count:  %d" time 1150 i   
end
0AB2: ret 0 
   
:Write_To_Ini_Files // 0@ 1@
0A97: 2@ = car 0@ struct
0AD3: 11@v = format "Car_%d" 1@
0AF1: write_int 2@ to_ini_file    "CLEO\SAMP++\car_hendle.ini" section  "Struct_Car" key 11@v 
0AB2: ret 0  